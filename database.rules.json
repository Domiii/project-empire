{
  "rules": {
    "dbState": {
      "current": {
        ".read": "auth !== null",
        ".write": "auth !== null && (root.child('users').child('public').child(auth.uid).child('role').val() >= 99)"
      }
    },

    "notifications": {
      ".read": "auth !== null",

      "public" : {
        ".indexOn": ["updatedAt", "type"],
        
        "$notificationId" : {
          ".write": "auth !== null && !data.exists() && newData.exists() && newData.child('uid').val() === auth.uid"
        }
      },

      "other" : {
        ".indexOn": ["updatedAt", "type"],
        
        "$notificationId" : {
          ".write": "auth !== null && !data.exists() && newData.exists() && newData.child('uid').val() === auth.uid"
        }
      }
    },
    
    "users": {
      "public": {
        ".read": "true",

        "$uid" : {
          "displayName": {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          },
          "photoURL": {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          },
          "role" : {
            ".write": "auth !== null && (root.child('users').child('public').child(auth.uid).child('role').val() >= 99)"
          },
          "displayRole" : {
            ".write": "auth !== null && (root.child('users').child('public').child(auth.uid).child('role').val() >= 99)"
          },
          "locale" : {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          },
          "updatedAt": {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          }
        }
      },
      "private": {
        "$uid" : {
          ".read": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))",
          
          "prefs": {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          },
          "updatedAt": {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          },
          "data": {
            ".write": "auth !== null && (($uid === auth.uid) || ((root.child('users').child('public').child(auth.uid).child('role').val() >= 99)))"
          }
        }
      }
    },

    "groups": {
      ".read": "auth !== null",

      "$groupId": {
        ".write": "auth !== null && (root.child('users').child('public').child(auth.uid).child('role').val() >= 99)"
      }
    },

    "_index": {
      "userGroups": {
        "user": {
          ".read": "auth !== null",
          ".write": "auth !== null && (root.child('users').child('public').child(auth.uid).child('role').val() >= 99)"
        },
        "group": {
          ".read": "auth !== null",
          ".write": "auth !== null && (root.child('users').child('public').child(auth.uid).child('role').val() >= 99)"
        }
      }
    }
  }
}